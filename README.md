## 水分汇总

- 回潮时间中年份改回2020年
- 时间加减用 TEXT 公式: TEXT(时间相减, "[h]:mm")
- 汇总需要把各处影响水分的点放一起?



## vbaDeveloper的使用

<https://github.com/hilkoc/vbaDeveloper>

手动打开vbaDeveloper.xlam, 就会出现加载项, 然后导出

## HDT烘丝入口水分

水分汇总表

汇总表中的日期,水分公式依旧可以运作



96线同步复制HDT数据

- 从96的HDT表中遍历经典HDT, 如果64加料表有这张工单, 然后64HDT表没有这张工单, 就进行append
- 通过手动的方式



## 加料语音提醒

锚点1: 开始时间(经常容易忘记)

- 开始时间容易忘记写,需要提醒
- 提醒的是这一批次烟开始后需要注意的东西, 如查看入柜状态,注意加料变异系数, 注意加料精度



锚点2: 结束时间, 提醒下一批要写开始时间, 检查加料变异系数, 检查风机频率, 检查加料系数, 检查入柜,  都是通用的提醒点

- 提醒这一批次结束后需要注意的地方
- 提醒下一批次没开前需要检查的地方
- 提醒要写下一批次的开始时间



批次的转烟时间, 同批次的转烟时间要20分钟左右, 不同批次的要分钟30左右



每批烟需要有三处提醒内容, 分别是开机前, 开机后, 结束后



## 回潮语音提醒

与加料提醒相同



## 烘丝加香语音提醒



烘丝上烟的时间点应该通过 msgbox 按确定的时间点为烘丝开始时间点, 

不再需要自动填写下一批次的开始时间

如何适当延长不同入柜的时间点



##  各牌号工艺参数与特殊点的提醒(是否需要?)

- 回潮锚点是开机前
- 加料锚点是开机前
- 烘丝锚点是开机前, 加香锚点是开机后

- 需要提供提醒内容和延时,
- 锚点直接写在程序上



## 语音提醒函数注意点

先检查日期

日期栏是今天或者空白

- 如果时间没超过10分钟, 那么进行过期提醒(立即语音)

- 超过10分钟不再提醒(进行提醒已经无作用)

日期栏过期

- 不进行提醒

​	

## 状态栏文字提醒

类似FIFO的列表



## 解决无法立即更新工作薄中的部分链接

HDT段的表先改为不保护的状态





## 两种找提示的方法

一个是固定的地方直接找延时和内容

一个是在固定的地方找指针, 在通过指针找到延时和内容



## 使用JSON记录语音数据和烟牌数据

default 的语音文件, 共同的提醒项目和开机前提醒

1. 第一批
2. 回潮段
3. 加料段
4. 切烘段

各牌号的文件, 牌号相关的语音还有牌号的各种参数

1. 牌号
   1. 回潮段
   2. 加料段
   3. 切烘段



json 文件的编码需要是 ANSI, 否则中文会变为乱码且无法正确解析



时间触发了提醒 -> 传参数(生产段, 时间基点, 烟牌名, 整体延时)到函数 -> 寻找 default 提醒点, 寻找各自牌号的提醒点,  基于柜的提醒(时间基点是开始后, 生产段是切烘和加料) -> 找提醒点并且安排好延后的提醒



## 提醒点分类

共同的提醒点

基于烟牌的提醒点(如是否需要HDT, 工艺参数的注意项)

基于柜的提醒点(如远一点的柜提醒的时间需要加长, 出现在切烘段和加料段)

前后烟牌对比后需要提醒的点(如何识别最后一组) - 可以不需要



## 可能存在的Bug

加班可能会让时间函数判断不用提醒





